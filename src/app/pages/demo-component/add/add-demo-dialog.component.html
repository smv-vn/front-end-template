<p-dialog 
    header="Thêm biên bản mới" 
    [(visible)]="visible" 
    [modal]="true" 
    [style]="{width: '600px'}"
    [closable]="true"
    [draggable]="false"
    [resizable]="false"
    (onHide)="onDialogHide()"
>
    <form [formGroup]="demoForm" (ngSubmit)="onSubmit()">
        <div class="grid">
            <!-- Mã biên bản -->
            <div class="col-12 md:col-6">
                <label for="code" class="block text-sm font-medium text-gray-700 mb-2">
                    Mã biên bản <span class="text-red-500">*</span>
                </label>
                <input 
                    id="code"
                    type="text" 
                    pInputText 
                    formControlName="code"
                    placeholder="Nhập mã biên bản"
                    class="w-full"
                    [class.ng-invalid]="formControls['code'].invalid && formControls['code'].touched"
                />
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['code'].invalid && formControls['code'].touched"
                >
                    {{ getFieldError('code') }}
                </small>
            </div>

            <!-- Đơn vị -->
            <div class="col-12 md:col-6">
                <label for="unit" class="block text-sm font-medium text-gray-700 mb-2">
                    Đơn vị <span class="text-red-500">*</span>
                </label>
                <input 
                    id="unit"
                    type="text" 
                    pInputText 
                    formControlName="unit"
                    placeholder="Nhập tên đơn vị"
                    class="w-full"
                    [class.ng-invalid]="formControls['unit'].invalid && formControls['unit'].touched"
                />
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['unit'].invalid && formControls['unit'].touched"
                >
                    {{ getFieldError('unit') }}
                </small>
            </div>

            <!-- Số nhân viên -->
            <div class="col-12 md:col-6">
                <label for="staffCount" class="block text-sm font-medium text-gray-700 mb-2">
                    Số nhân viên <span class="text-red-500">*</span>
                </label>
                <input 
                    id="staffCount"
                    type="text" 
                    pInputText 
                    formControlName="staffCount"
                    placeholder="Nhập số nhân viên"
                    class="w-full"
                    [class.ng-invalid]="formControls['staffCount'].invalid && formControls['staffCount'].touched"
                />
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['staffCount'].invalid && formControls['staffCount'].touched"
                >
                    {{ getFieldError('staffCount') }}
                </small>
            </div>

            <!-- Trạng thái -->
            <div class="col-12 md:col-6">
                <label for="status" class="block text-sm font-medium text-gray-700 mb-2">
                    Trạng thái <span class="text-red-500">*</span>
                </label>
                <p-dropdown
                    id="status"
                    [options]="statusOptions"
                    formControlName="status"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="Chọn trạng thái"
                    class="w-full"
                    [class.ng-invalid]="formControls['status'].invalid && formControls['status'].touched"
                ></p-dropdown>
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['status'].invalid && formControls['status'].touched"
                >
                    {{ getFieldError('status') }}
                </small>
            </div>

            <!-- Thời gian bắt đầu -->
            <div class="col-12 md:col-6">
                <label for="startTime" class="block text-sm font-medium text-gray-700 mb-2">
                    Thời gian có hiệu lực <span class="text-red-500">*</span>
                </label>
                <p-calendar
                    id="startTime"
                    formControlName="startTime"
                    placeholder="Chọn thời gian"
                    [showTime]="true"
                    [hourFormat]="'24'"
                    dateFormat="dd/mm/yy"
                    class="w-full"
                    [class.ng-invalid]="formControls['startTime'].invalid && formControls['startTime'].touched"
                ></p-calendar>
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['startTime'].invalid && formControls['startTime'].touched"
                >
                    {{ getFieldError('startTime') }}
                </small>
            </div>

            <!-- Thời gian kết thúc -->
            <div class="col-12 md:col-6">
                <label for="endTime" class="block text-sm font-medium text-gray-700 mb-2">
                    Thời gian hết hiệu lực <span class="text-red-500">*</span>
                </label>
                <p-calendar
                    id="endTime"
                    formControlName="endTime"
                    placeholder="Chọn thời gian"
                    [showTime]="true"
                    [hourFormat]="'24'"
                    dateFormat="dd/mm/yy"
                    class="w-full"
                    [class.ng-invalid]="formControls['endTime'].invalid && formControls['endTime'].touched"
                ></p-calendar>
                <small 
                    class="p-error block mt-1" 
                    *ngIf="formControls['endTime'].invalid && formControls['endTime'].touched"
                >
                    {{ getFieldError('endTime') }}
                </small>
            </div>

            <!-- Mô tả -->
            <div class="col-12">
                <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                    Mô tả
                </label>
                <textarea 
                    id="description"
                    pInputTextarea 
                    formControlName="description"
                    placeholder="Nhập mô tả (tùy chọn)"
                    class="w-full"
                    rows="3"
                ></textarea>
            </div>
        </div>
    </form>

    <ng-template pTemplate="footer">
        <div class="flex justify-content-end gap-2">
            <button 
                pButton 
                type="button" 
                label="Hủy" 
                class="p-button-outlined p-button-secondary"
                (click)="closeDialog()"
                [disabled]="isSubmitting"
            ></button>
            <button 
                pButton 
                type="button" 
                label="Thêm mới" 
                class="p-button-primary"
                (click)="onSubmit()"
                [disabled]="demoForm.invalid || isSubmitting"
                [loading]="isSubmitting"
            ></button>
        </div>
    </ng-template>
</p-dialog>
