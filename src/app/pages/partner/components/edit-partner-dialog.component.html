<form [formGroup]="partnerForm" (ngSubmit)="onSubmit()" class="p-4">
    <div class="formgrid grid">
        <!-- Tên đối tác -->
        <div class="field col-12">
            <label for="name" class="block text-900 font-medium mb-2">
                Tên đối tác <span class="text-red-500">*</span>
            </label>
            <input
                id="name"
                type="text"
                pInputText
                formControlName="name"
                placeholder="Nhập tên đối tác"
                class="w-full"
                [class.ng-invalid]="hasFieldError('name')"
                [class.ng-dirty]="hasFieldError('name')"
            />
            <small *ngIf="hasFieldError('name')" class="p-error block mt-1">
                {{ getFieldError("name") }}
            </small>
        </div>

        <!-- Mã đối tác -->
        <div class="field col-12">
            <label for="code" class="block text-900 font-medium mb-2">
                Mã đối tác <span class="text-red-500">*</span>
            </label>
            <input
                id="code"
                type="text"
                pInputText
                formControlName="code"
                placeholder="Nhập mã đối tác (VD: SMC, DIG)"
                class="w-full"
                [class.ng-invalid]="hasFieldError('code')"
                [class.ng-dirty]="hasFieldError('code')"
                style="text-transform: uppercase"
            />
            <small *ngIf="hasFieldError('code')" class="p-error block mt-1">
                {{ getFieldError("code") }}
            </small>
        </div>

        <!-- Số điện thoại -->
        <div class="field col-12">
            <label for="phone" class="block text-900 font-medium mb-2">
                Số điện thoại <span class="text-red-500">*</span>
            </label>
            <input
                id="phone"
                type="tel"
                pInputText
                formControlName="phone"
                placeholder="Nhập số điện thoại (10-11 số)"
                class="w-full"
                [class.ng-invalid]="hasFieldError('phone')"
                [class.ng-dirty]="hasFieldError('phone')"
            />
            <small *ngIf="hasFieldError('phone')" class="p-error block mt-1">
                {{ getFieldError("phone") }}
            </small>
        </div>

        <!-- Địa chỉ -->
        <div class="field col-12">
            <label for="address" class="block text-900 font-medium mb-2">
                Địa chỉ <span class="text-red-500">*</span>
            </label>
            <textarea
                id="address"
                pInputTextarea
                formControlName="address"
                placeholder="Nhập địa chỉ đầy đủ"
                class="w-full"
                rows="3"
                [class.ng-invalid]="hasFieldError('address')"
                [class.ng-dirty]="hasFieldError('address')"
            ></textarea>
            <small *ngIf="hasFieldError('address')" class="p-error block mt-1">
                {{ getFieldError("address") }}
            </small>
        </div>

        <!-- Mô tả -->
        <div class="field col-12">
            <label for="description" class="block text-900 font-medium mb-2">
                Mô tả
            </label>
            <textarea
                id="description"
                pInputTextarea
                formControlName="description"
                placeholder="Mô tả về đối tác (tùy chọn)"
                class="w-full"
                rows="3"
                [class.ng-invalid]="hasFieldError('description')"
                [class.ng-dirty]="hasFieldError('description')"
            ></textarea>
            <small
                *ngIf="hasFieldError('description')"
                class="p-error block mt-1"
            >
                {{ getFieldError("description") }}
            </small>
        </div>

        <!-- Upload ảnh -->
        <div class="field col-12">
            <label class="block text-900 font-medium mb-2">
                Ảnh đại diện
            </label>

            <div class="flex align-items-center gap-3" *ngIf="!imagePreview">
                <p-fileUpload
                    mode="basic"
                    chooseLabel="Chọn ảnh"
                    accept="image/png,image/jpg,image/jpeg,image/svg+xml"
                    [maxFileSize]="maxFileSize"
                    (onSelect)="onFileSelect($event)"
                    [auto]="true"
                    chooseIcon="pi pi-upload"
                ></p-fileUpload>
                <small class="text-500">
                    PNG, JPG, JPEG, SVG. Tối đa 5MB
                </small>
            </div>

            <!-- Image Preview -->
            <div class="flex align-items-center gap-3" *ngIf="imagePreview">
                <p-avatar
                    [image]="imagePreview"
                    size="xlarge"
                    shape="circle"
                    class="border-2 border-300"
                ></p-avatar>
                <div class="flex flex-column gap-2">
                    <span class="text-sm text-500" *ngIf="selectedFile">{{
                        selectedFile.name
                    }}</span>
                    <span
                        class="text-sm text-500"
                        *ngIf="!selectedFile && partner.avatar"
                        >Ảnh hiện tại</span
                    >
                    <p-button
                        icon="pi pi-trash"
                        severity="danger"
                        size="small"
                        outlined="true"
                        label="Xóa ảnh"
                        (onClick)="onFileRemove()"
                    ></p-button>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-content-end gap-2 pt-3 border-top-1 border-300">
        <p-button
            label="Hủy"
            severity="secondary"
            outlined="true"
            (onClick)="onCancel()"
            [disabled]="loading"
        ></p-button>
        <p-button
            label="Cập nhật"
            type="submit"
            [loading]="loading"
            [disabled]="partnerForm.invalid"
        ></p-button>
    </div>
</form>
